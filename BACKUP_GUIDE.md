# 🔒 出雲大社東京分祠 バックアップガイド

## 📋 概要

このガイドでは、Webサイトデータの安全なバックアップと復元方法を説明します。

---

## 🎯 バックアップの種類

### 1. AIドライブバックアップ（自動・推奨）
- **保存先**: `/mnt/aidrive/出雲大社東京分祠/`
- **形式**: tar.gz圧縮ファイル
- **利点**: サンドボックスが変わっても永続的に保存

### 2. Gitバックアップ（バージョン管理）
- **保存先**: ローカルGitリポジトリ
- **利点**: 変更履歴を追跡できる
- **制限**: サンドボックスが変わると失われる

---

## 🚀 使い方

### **バックアップを作成**

```bash
cd /home/user/webapp
./backup.sh
```

**これで以下が実行されます:**
1. ✅ AIドライブに圧縮ファイル保存
2. ✅ Gitコミット（初期化済みの場合）
3. ✅ 最新5件のバックアップリスト表示

---

### **バックアップから復元**

```bash
cd /home/user/webapp
./restore.sh
```

**手順:**
1. 利用可能なバックアップリストが表示される
2. 復元したいバックアップの番号を入力（最新は1）
3. `yes`で確認して復元開始

---

## 📅 推奨バックアップタイミング

以下のタイミングでバックアップを取ることを推奨します：

1. ✅ **大きな変更の前後**
   - ページ追加・削除
   - デザイン大幅変更
   - 画像の大量追加

2. ✅ **作業の節目**
   - 1日の作業終了時
   - 機能実装完了時
   - デプロイ前

3. ✅ **重要な更新前**
   - 本番環境へのデプロイ前
   - クライアントへの納品前

---

## 🔍 バックアップの確認

AIドライブ内のバックアップを確認：

```bash
ls -lht /mnt/aidrive/出雲大社東京分祠/backup_*.tar.gz | head -10
```

---

## 💡 便利なコマンド

### 手動でAIドライブにバックアップ

```bash
cd /home/user/webapp
tar -czf "/mnt/aidrive/出雲大社東京分祠/manual_backup_$(date +%Y%m%d_%H%M%S).tar.gz" .
```

### Gitコミット

```bash
cd /home/user/webapp
git add .
git commit -m "作業内容の説明"
```

### 古いバックアップを削除

```bash
# 30日以上前のバックアップを削除
find /mnt/aidrive/出雲大社東京分祠/ -name "backup_*.tar.gz" -mtime +30 -delete
```

---

## ⚠️ 注意事項

1. **AIドライブは遅い**: 大量の小さいファイルではなく、圧縮ファイルで保存
2. **バックアップの定期確認**: 月に1回は復元テストを実行
3. **複数の保存先**: 重要な場合はGitHubにもプッシュを推奨

---

## 🆘 トラブルシューティング

### Q: バックアップスクリプトが実行できない
```bash
chmod +x /home/user/webapp/backup.sh
chmod +x /home/user/webapp/restore.sh
```

### Q: AIドライブがマウントされていない
```bash
ls /mnt/aidrive/
```
結果が空の場合、サンドボックスを再起動してください。

### Q: Gitリポジトリが壊れた
```bash
cd /home/user/webapp
rm -rf .git
git init
git add .
git commit -m "Re-initialize repository"
```

---

## 📞 サポート

問題が発生した場合は、上田社長にご連絡ください。

作成日: 2025-12-20
